<% include includes/header %>

<div class="container">
    <div class="row">
        <div class="span2">
            <% include includes/lefter %>
        </div>
        <div class="span10">
            <% include includes/error_alert %>
            <% include includes/success_alert %>
            <div class="topmenu">
                <div class="manbtn">
                    <button id="savedraft" type="button" class="btn"><i class="icon-plus"></i> 保存到草稿</button>
                </div>
                <div class="manbtn">
                    <button id="publish" type="button" class="btn btn-success"><i class="icon-plus icon-white"></i> 发 布</button>
                </div>
                写文章
            </div>
            <script type="text/javascript" charset="utf-8" src="/after/ueditor/ueditor.config.js"></script>
            <script type="text/javascript" charset="utf-8" src="/after/ueditor/ueditor.all.js"></script>
            <form id="warticleForm" class="form-horizontal" method="post" action="/admin/addarticle">
                <div class="control-group">
                    <label class="control-label" style="width: 60px;text-align: left;" for="articleTitle">文章标题</label>
                    <div class="controls" style="margin-left: 75px;">
                        <input type="text" class="span4" id="articleTitle" name="articleTitle" placeholder="文章标题">
                        <input type="hidden" name="articlestatus" id="articlestatus">
                        <input type="hidden" id="imageName" name="imageName">
                        <input type="hidden" id="attachName" name="attachName">
                    </div>
                </div>
                <script id="content" name="content" type="text/plain" style="height:350px;">
                </script>
                <script type="text/javascript">
                    var ue = UE.getEditor('content');
                </script>
                <div>&nbsp;</div>
                <div class="control-group">
                    <label class="control-label" style="width: 60px;text-align: left;" for="aclassify">文章分类</label>
                    <div class="controls" style="margin-left: 75px;">
                        <select class="span4" id="aclassify" name="aclassifyId">
                            <option value="0">未分类</option>
                            <% acs.forEach(function(ac){ %>
                            <option value="<%= ac._id %>"><%= ac.acname %></option>
                            <% }) %>
                        </select>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" style="width: 60px;text-align: left;" for="alabel">文章标签</label>
                    <div class="controls" style="margin-left: 75px;">
                        <input type="text" id="alabel" style="width:370px;">
                        <input type="hidden" name="alabelId" id="hiddenAlabel" value="">
                        <script>
                            $("#publish").on('click',function(){
                                $("#articlestatus").val('publish');
                                $("#warticleForm").submit();
                            });
                            $("#savedraft").on('click',function(){
                                $("#articlestatus").val('draft');
                                $("#warticleForm").submit();
                            });
                            $('#alabel').selectize({
                                plugins: ['remove_button'],
                                delimiter: ',',
                                persist: false,
                                valueField:'_id',
                                labelField:'alname',
                                maxItems:5,
                                options:<%=als %>,
                                create: function(input) {
                                    return {
                                        value: input,
                                        text: input
                                    }
                                },
                                onChange:function(value){
                                    $('#hiddenAlabel').val(value);
                                }
                            });
                        </script>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<% include includes/footer %>